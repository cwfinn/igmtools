"""
Fast cosmology functions.

"""

from __future__ import (absolute_import, division, print_function,
                        unicode_literals)

from astropy.units import Mpc, deg

import numpy as np

# Planck Cosmology:
# H0 = 67.77, Om0 = 0.307, Ol0 = 0.693

__all__ = ['comoving_distance', 'Mpc_comoving_per_degree']

degree_in_radians = np.pi / 180

# Redshift values corresponding to the table of comoving distances below:
z0 = np.linspace(0, 10, 1000)

# Table of comoving distances in Mpc:
dc = np.array([
    0.00000000, 44.178724060, 88.15202239, 131.91872634, 175.47773061,
    218.82799299, 261.96853406, 304.89843679, 347.61684617, 390.12296863,
    432.41607154, 474.49548262, 516.36058919, 558.01083757, 599.44573225,
    640.66483512, 681.66776461, 722.45419483, 763.02385467, 803.37652681,
    843.51204677, 883.43030193, 923.13123045, 962.61482027, 1001.88110802,
    1040.93017792, 1079.76216071, 1118.37723252, 1156.77561375, 1194.95756793,
    1232.92340060, 1270.67345815, 1308.20812670, 1345.52783091, 1382.63303290,
    1419.52423107, 1456.20195894, 1492.66678409, 1528.91930697, 1564.96015983,
    1600.79000557, 1636.40953671, 1671.81947422, 1707.02056653, 1742.01358845,
    1776.79934008, 1811.37864585, 1845.75235349, 1879.92133299, 1913.88647569,
    1947.64869328, 1981.20891685, 2014.56809600, 2047.72719791, 2080.68720646,
    2113.44912135, 2146.01395730, 2178.38274314, 2210.55652109, 2242.53634590,
    2274.32328413, 2305.91841335, 2337.32282148, 2368.53760601, 2399.56387334,
    2430.40273812, 2461.05532258, 2491.52275590, 2521.80617357, 2551.90671686,
    2581.82553219, 2611.56377056, 2641.12258705, 2670.50314028, 2699.70659189,
    2728.73410607, 2757.58684905, 2786.26598872, 2814.77269409, 2843.10813494,
    2871.27348140, 2899.26990352, 2927.09857093, 2954.76065243, 2982.25731572,
    3009.58972697, 3036.75905056, 3063.76644873, 3090.61308134, 3117.30010550,
    3143.82867539, 3170.19994193, 3196.41505257, 3222.47515101, 3248.38137705,
    3274.13486628, 3299.73674994, 3325.18815471, 3350.49020249, 3375.64401029,
    3400.65068999, 3425.51134821, 3450.22708619, 3474.79899960, 3499.22817843,
    3523.51570685, 3547.66266312, 3571.67011943, 3595.53914186, 3619.27079020,
    3642.86611794, 3666.32617212, 3689.65199331, 3712.84461546, 3735.90506593,
    3758.83436532, 3781.63352750, 3804.30355952, 3826.84546157, 3849.26022692,
    3871.54884190, 3893.71228586, 3915.75153117, 3937.66754313, 3959.46128001,
    3981.13369298, 4002.68572614, 4024.11831649, 4045.43239391, 4066.62888118,
    4087.70869395, 4108.67274077, 4129.52192306, 4150.25713514, 4170.87926423,
    4191.38919048, 4211.78778694, 4232.07591961, 4252.25444745, 4272.32422241,
    4292.28608940, 4312.14088639, 4331.88944437, 4351.53258741, 4371.07113267,
    4390.50589045, 4409.83766420, 4429.06725056, 4448.19543939, 4467.22301379,
    4486.15075019, 4504.97941829, 4523.70978121, 4542.34259543, 4560.87861089,
    4579.31857100, 4597.66321269, 4615.91326645, 4634.06945637, 4652.13250018,
    4670.10310932, 4687.98198891, 4705.76983790, 4723.46734901, 4741.07520884,
    4758.59409789, 4776.02469062, 4793.36765548, 4810.62365495, 4827.79334562,
    4844.87737819, 4861.87639756, 4878.79104282, 4895.62194738, 4912.36973892,
    4929.03503952, 4945.61846566, 4962.12062826, 4978.54213277, 4994.88357918,
    5011.14556206, 5027.32867066, 5043.43348887, 5059.46059537, 5075.41056357,
    5091.28396175, 5107.08135304, 5122.80329550, 5138.45034214, 5154.02304099,
    5169.52193515, 5184.94756279, 5200.30045726, 5215.58114706, 5230.79015595,
    5245.92800298, 5260.99520248, 5275.99226420, 5290.91969325, 5305.77799021,
    5320.56765118, 5335.28916776, 5349.94302714, 5364.52971216, 5379.04970129,
    5393.50346872, 5407.89148439, 5422.21421402, 5436.47211915, 5450.66565722,
    5464.79528155, 5478.86144140, 5492.86458206, 5506.80514481, 5520.68356700,
    5534.50028210, 5548.25571971, 5561.95030560, 5575.58446179, 5589.15860652,
    5602.67315433, 5616.12851611, 5629.52509908, 5642.86330689, 5656.14353960,
    5669.36619377, 5682.53166243, 5695.64033518, 5708.69259819, 5721.68883422,
    5734.62942269, 5747.51473969, 5760.34515803, 5773.12104723, 5785.84277363,
    5798.51070033, 5811.12518730, 5823.68659137, 5836.19526626, 5848.65156264,
    5861.05582813, 5873.40840733, 5885.70964190, 5897.95987051, 5910.15942894,
    5922.30865007, 5934.40786391, 5946.45739766, 5958.45757569, 5970.40871962,
    5982.31114831, 5994.16517788, 6005.97112179, 6017.72929081, 6029.43999308,
    6041.10353412, 6052.72021686, 6064.29034167, 6075.81420639, 6087.29210633,
    6098.72433433, 6110.11118077, 6121.45293357, 6132.74987825, 6144.00229796,
    6155.21047344, 6166.37468312, 6177.49520311, 6188.57230720, 6199.60626692,
    6210.59735157, 6221.54582817, 6232.45196158, 6243.31601445, 6254.13824727,
    6264.91891840, 6275.65828405, 6286.35659835, 6297.01411335, 6307.63107902,
    6318.20774333, 6328.74435218, 6339.24114950, 6349.69837723, 6360.11627537,
    6370.49508193, 6380.83503305, 6391.13636292, 6401.39930388, 6411.62408638,
    6421.81093902, 6431.96008858, 6442.07176002, 6452.14617650, 6462.18355940,
    6472.18412834, 6482.14810120, 6492.07569412, 6501.96712154, 6511.82259620,
    6521.64232916, 6531.42652981, 6541.17540590, 6550.88916356, 6560.56800727,
    6570.21213994, 6579.82176289, 6589.39707586, 6598.93827704, 6608.44556309,
    6617.91912911, 6627.35916872, 6636.76587404, 6646.13943569, 6655.48004285,
    6664.78788320, 6674.06314302, 6683.30600714, 6692.51665898, 6701.69528056,
    6710.84205251, 6719.95715408, 6729.04076317, 6738.09305632, 6747.11420874,
    6756.10439429, 6765.06378556, 6773.99255380, 6782.89086900, 6791.75889985,
    6800.59681379, 6809.40477700, 6818.18295443, 6826.93150978, 6835.65060555,
    6844.34040302, 6853.00106228, 6861.63274223, 6870.23560059, 6878.80979393,
    6887.35547766, 6895.87280604, 6904.36193220, 6912.82300816, 6921.25618480,
    6929.66161193, 6938.03943825, 6946.38981137, 6954.71287785, 6963.00878317,
    6971.27767176, 6979.51968699, 6987.73497124, 6995.92366581, 7004.08591103,
    7012.22184618, 7020.33160957, 7028.41533853, 7036.47316937, 7044.50523746,
    7052.51167719, 7060.49262201, 7068.44820441, 7076.37855596, 7084.28380726,
    7092.16408804, 7100.01952708, 7107.85025226, 7115.65639057, 7123.43806812,
    7131.19541011, 7138.92854088, 7146.63758391, 7154.32266181, 7161.98389635,
    7169.62140843, 7177.23531815, 7184.82574474, 7192.39280664, 7199.93662145,
    7207.45730598, 7214.95497622, 7222.42974738, 7229.88173388, 7237.31104934,
    7244.71780663, 7252.10211785, 7259.46409431, 7266.80384659, 7274.12148451,
    7281.41711716, 7288.69085289, 7295.94279930, 7303.17306329, 7310.38175104,
    7317.56896800, 7324.73481892, 7331.87940787, 7339.00283821, 7346.10521260,
    7353.18663304, 7360.24720085, 7367.28701665, 7374.30618043, 7381.30479151,
    7388.28294854, 7395.24074953, 7402.17829186, 7409.09567225, 7415.99298680,
    7422.87033097, 7429.72779960, 7436.56548693, 7443.38348655, 7450.18189149,
    7456.96079414, 7463.72028629, 7470.46045917, 7477.18140339, 7483.88320899,
    7490.56596543, 7497.22976159, 7503.87468579, 7510.50082577, 7517.10826873,
    7523.69710129, 7530.26740954, 7536.81927901, 7543.35279469, 7549.86804104,
    7556.36510197, 7562.84406086, 7569.30500059, 7575.74800349, 7582.17315139,
    7588.58052559, 7594.97020689, 7601.34227559, 7607.69681149, 7614.03389388,
    7620.35360155, 7626.65601283, 7632.94120555, 7639.20925703, 7645.46024417,
    7651.69424333, 7657.91133045, 7664.11158099, 7670.29506992, 7676.46187179,
    7682.61206066, 7688.74571015, 7694.86289344, 7700.96368326, 7707.04815189,
    7713.11637116, 7719.16841249, 7725.20434686, 7731.22424480, 7737.22817645,
    7743.21621150, 7749.18841922, 7755.14486849, 7761.08562774, 7767.01076502,
    7772.92034796, 7778.81444379, 7784.69311933, 7790.55644102, 7796.40447490,
    7802.23728659, 7808.05494137, 7813.85750410, 7819.64503925, 7825.41761095,
    7831.17528292, 7836.91811850, 7842.64618068, 7848.35953208, 7854.05823494,
    7859.74235114, 7865.41194221, 7871.06706930, 7876.70779323, 7882.33417445,
    7887.94627307, 7893.54414883, 7899.12786116, 7904.69746912, 7910.25303144,
    7915.79460650, 7921.32225237, 7926.83602677, 7932.33598709, 7937.82219038,
    7943.29469340, 7948.75355255, 7954.19882393, 7959.63056330, 7965.04882614,
    7970.45366758, 7975.84514246, 7981.22330530, 7986.58821031, 7991.93991140,
    7997.27846218, 8002.60391596, 8007.91632574, 8013.21574423, 8018.50222386,
    8023.77581673, 8029.03657468, 8034.28454927, 8039.51979174, 8044.74235307,
    8049.95228395, 8055.14963480, 8060.33445574, 8065.50679663, 8070.66670705,
    8075.81423632, 8080.94943347, 8086.07234726, 8091.18302621, 8096.28151855,
    8101.36787226, 8106.44213505, 8111.50435436, 8116.55457740, 8121.59285111,
    8126.61922218, 8131.63373702, 8136.63644184, 8141.62738255, 8146.60660484,
    8151.57415416, 8156.53007570, 8161.47441442, 8166.40721502, 8171.32852198,
    8176.23837953, 8181.13683169, 8186.02392220, 8190.89969461, 8195.76419222,
    8200.61745809, 8205.45953509, 8210.29046582, 8215.11029267, 8219.91905782,
    8224.71680322, 8229.50357059, 8234.27940144, 8239.04433707, 8243.79841854,
    8248.54168672, 8253.27418226, 8257.99594559, 8262.70701693, 8267.40743630,
    8272.09724352, 8276.77647818, 8281.44517967, 8286.10338720, 8290.75113976,
    8295.38847613, 8300.01543491, 8304.63205449, 8309.23837306, 8313.83442863,
    8318.42025899, 8322.99590177, 8327.56139439, 8332.11677407, 8336.66207785,
    8341.19734259, 8345.72260496, 8350.23790142, 8354.74326828, 8359.23874165,
    8363.72435746, 8368.20015146, 8372.66615921, 8377.12241611, 8381.56895736,
    8386.00581801, 8390.43303291, 8394.85063675, 8399.25866404, 8403.65714913,
    8408.04612618, 8412.42562920, 8416.79569201, 8421.15634829, 8425.50763152,
    8429.84957505, 8434.18221203, 8438.50557547, 8442.81969821, 8447.12461294,
    8451.42035216, 8455.70694825, 8459.98443340, 8464.25283966, 8468.51219891,
    8472.76254289, 8477.00390317, 8481.23631118, 8485.45979819, 8489.67439532,
    8493.88013353, 8498.07704365, 8502.26515634, 8506.44450214, 8510.61511140,
    8514.77701437, 8518.93024112, 8523.07482160, 8527.21078560, 8531.33816277,
    8535.45698262, 8539.56727453, 8543.66906772, 8547.76239129, 8551.84727419,
    8555.92374523, 8559.99183310, 8564.05156633, 8568.10297333, 8572.14608238,
    8576.18092161, 8580.20751904, 8584.22590254, 8588.23609985, 8592.23813859,
    8596.23204624, 8600.21785017, 8604.19557759, 8608.16525561, 8612.12691120,
    8616.08057122, 8620.02626238, 8623.96401129, 8627.89384443, 8631.81578814,
    8635.72986867, 8639.63611211, 8643.53454447, 8647.42519160, 8651.30807927,
    8655.18323311, 8659.05067862, 8662.91044122, 8666.76254617, 8670.60701865,
    8674.44388371, 8678.27316629, 8682.09489120, 8685.90908316, 8689.71576677,
    8693.51496650, 8697.30670675, 8701.09101176, 8704.86790570, 8708.63741261,
    8712.39955644, 8716.15436100, 8719.90185002, 8723.64204712, 8727.37497580,
    8731.10065947, 8734.81912143, 8738.53038487, 8742.23447289, 8745.93140847,
    8749.62121450, 8753.30391377, 8756.97952895, 8760.64808262, 8764.30959728,
    8767.96409530, 8771.61159896, 8775.25213045, 8778.88571186, 8782.51236518,
    8786.13211229, 8789.74497500, 8793.35097500, 8796.95013391, 8800.54247323,
    8804.12801438, 8807.70677868, 8811.27878737, 8814.84406157, 8818.40262234,
    8821.95449064, 8825.49968731, 8829.03823314, 8832.57014881, 8836.09545491,
    8839.61417195, 8843.12632033, 8846.63192040, 8850.13099238, 8853.62355643,
    8857.10963262, 8860.58924093, 8864.06240125, 8867.52913339, 8870.98945707,
    8874.44339194, 8877.89095755, 8881.33217338, 8884.76705882, 8888.19563316,
    8891.61791565, 8895.03392542, 8898.44368154, 8901.84720299, 8905.24450866,
    8908.63561740, 8912.02054793, 8915.39931892, 8918.77194897, 8922.13845656,
    8925.49886015, 8928.85317807, 8932.20142861, 8935.54362996, 8938.87980025,
    8942.20995752, 8945.53411975, 8948.85230484, 8952.16453061, 8955.47081481,
    8958.77117511, 8962.06562912, 8965.35419437, 8968.63688831, 8971.91372834,
    8975.18473175, 8978.44991581, 8981.70929767, 8984.96289443, 8988.21072314,
    8991.45280075, 8994.68914414, 8997.91977015, 9001.14469553, 9004.36393696,
    9007.57751105, 9010.78543436, 9013.98772338, 9017.18439450, 9020.37546409,
    9023.56094843, 9026.74086373, 9029.91522613, 9033.08405174, 9036.24735657,
    9039.40515657, 9042.55746763, 9045.70430559, 9048.84568620, 9051.98162518,
    9055.11213815, 9058.23724069, 9061.35694832, 9064.47127649, 9067.58024058,
    9070.68385592, 9073.78213779, 9076.87510138, 9079.96276184, 9083.04513427,
    9086.12223368, 9089.19407504, 9092.26067326, 9095.32204318, 9098.37819961,
    9101.42915726, 9104.47493082, 9107.51553489, 9110.55098405, 9113.58129278,
    9116.60647553, 9119.62654669, 9122.64152060, 9125.65141152, 9128.65623368,
    9131.65600124, 9134.65072831, 9137.64042895, 9140.62511714, 9143.60480685,
    9146.57951197, 9149.54924633, 9152.51402373, 9155.47385787, 9158.42876244,
    9161.37875106, 9164.32383732, 9167.26403472, 9170.19935675, 9173.12981681,
    9176.05542827, 9178.97620444, 9181.89215859, 9184.80330393, 9187.70965361,
    9190.61122077, 9193.50801844, 9196.40005965, 9199.28735736, 9202.16992448,
    9205.04777387, 9207.92091836, 9210.78937070, 9213.65314362, 9216.51224978,
    9219.36670181, 9222.21651229, 9225.06169374, 9227.90225864, 9230.73821942,
    9233.56958848, 9236.39637815, 9239.21860072, 9242.03626846, 9244.84939355,
    9247.65798815, 9250.46206438, 9253.26163430, 9256.05670993, 9258.84730326,
    9261.63342621, 9264.41509066, 9267.19230847, 9269.96509144, 9272.73345131,
    9275.49739981, 9278.25694859, 9281.01210930, 9283.76289351, 9286.50931276,
    9289.25137855, 9291.98910235, 9294.72249555, 9297.45156954, 9300.17633564,
    9302.89680515, 9305.61298931, 9308.32489933, 9311.03254638, 9313.73594158,
    9316.43509602, 9319.13002073, 9321.82072673, 9324.50722498, 9327.18952641,
    9329.86764190, 9332.54158229, 9335.21135839, 9337.87698098, 9340.53846078,
    9343.19580847, 9345.84903472, 9348.49815013, 9351.14316528, 9353.78409070,
    9356.42093691, 9359.05371435, 9361.68243346, 9364.30710462, 9366.92773818,
    9369.54434445, 9372.15693372, 9374.76551621, 9377.37010214, 9379.97070167,
    9382.56732494, 9385.15998203, 9387.74868301, 9390.33343790, 9392.91425670,
    9395.49114935, 9398.06412576, 9400.63319584, 9403.19836942, 9405.75965631,
    9408.31706630, 9410.87060914, 9413.42029452, 9415.96613214, 9418.50813162,
    9421.04630259, 9423.58065462, 9426.11119724, 9428.63793997, 9431.16089229,
    9433.68006363, 9436.19546341, 9438.70710100, 9441.21498576, 9443.71912698,
    9446.21953395, 9448.71621593, 9451.20918212, 9453.69844171, 9456.18400386,
    9458.66587768, 9461.14407226, 9463.61859666, 9466.08945992, 9468.55667102,
    9471.02023893, 9473.48017259, 9475.93648090, 9478.38917273, 9480.83825693,
    9483.28374231, 9485.72563766, 9488.16395173, 9490.59869323, 9493.02987088,
    9495.45749332, 9497.88156919, 9500.30210711, 9502.71911564, 9505.13260334,
    9507.54257873, 9509.94905028, 9512.35202647, 9514.75151573, 9517.14752646,
    9519.54006704, 9521.92914581, 9524.31477110, 9526.69695120, 9529.07569437,
    9531.45100885, 9533.82290284, 9536.19138454, 9538.55646209, 9540.91814362,
    9543.27643723, 9545.63135100, 9547.98289296, 9550.33107115, 9552.67589355,
    9555.01736812, 9557.35550282, 9559.69030555, 9562.02178419, 9564.34994662,
    9566.67480067, 9568.99635414, 9571.31461482, 9573.62959048, 9575.94128883,
    9578.24971759, 9580.55488445, 9582.85679705, 9585.15546303, 9587.45088999,
    9589.74308553, 9592.03205719, 9594.31781251, 9596.60035900, 9598.87970413,
    9601.15585538, 9603.42882016, 9605.69860590, 9607.96521999, 9610.22866977,
    9612.48896260, 9614.74610578, 9617.00010662, 9619.25097237, 9621.49871028,
    9623.74332757, 9625.98483144, 9628.22322907, 9630.45852760, 9632.69073417,
    9634.91985587, 9637.14589980, 9639.36887301, 9641.58878254, 9643.80563541,
    9646.01943860, 9648.23019909, 9650.43792383, 9652.64261973, 9654.84429372,
    9657.04295266, 9659.23860342, 9661.43125283, 9663.62090771, 9665.80757486])


def comoving_distance(z):
    """
    Fast approximation for the comoving distance in Planck 2013 cosmology.

    """

    return np.interp(z, z0, dc) * Mpc


def Mpc_comoving_per_degree(z):
    """
    Fast approximation for transverse distance in Planck 2013 cosmology.

    """

    dc0 = comoving_distance(z)
    return dc0 * degree_in_radians / deg
